{"version":3,"sources":["webpack://Computed/webpack/universalModuleDefinition","webpack://Computed/webpack/bootstrap","webpack://Computed/./lib/index.js","webpack://Computed/./src/computed.js","webpack://Computed/./src/dep.js","webpack://Computed/./src/index.js","webpack://Computed/./src/observe.js","webpack://Computed/./src/util.js","webpack://Computed/./src/watcher.js"],"names":["util","initData","opts","isObject","data","prop","initComputed","ctx","cb","computed","_computedWatchers","watcher","Watcher","bind","undefined","createComputedGetter","dirty","evaluate","Dep","target","depend","value","Object","defineProperty","enumerable","configurable","set","noop","get","Computed","force","obj","assign","pushStack","popStack","$$dep_count","subs","id","addDep","update","targetStack","o","push","pop","length","ComputedPage","PageFunction","PageConfigObject","onLoad","setData","computedData","getComputed","args","call","observe","ob","hasOwn","__ob__","Observer","def","walk","keys","i","l","defineReactive","k","hasOwnProperty","writable","key","val","dep","property","getOwnPropertyDescriptor","getter","setter","arguments","childOb","newVal","notify","$$watcher_count","callUpdateManually","deps","newDeps","err","cleanupDeps","oldValue","removeSub","addSub"],"mappings":"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","file":"wx-computed.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Computed\"] = factory();\n\telse\n\t\troot[\"Computed\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./lib/index.js\");\n","const Computed = require('../src');\n\nmodule.exports = Computed.default;\n\nexports = module.exports;\n\nexports.default = module.exports;\n","// @flow\n\nimport * as util from './util';\nimport observe from './observe';\nimport Watcher from './watcher';\nimport Dep from './dep';\n\nfunction initData(opts: any) {\n  if (util.isObject(opts) && util.isObject(opts.data)) {\n    for (const prop in opts.data) {\n      observe(opts.data);\n    }\n  }\n}\n\nfunction initComputed(\n  ctx: Computed,\n  opts: Object,\n  cb?: (prop?: string, newVal?: any, oldVal?: any) => any\n) {\n  if (util.isObject(opts) && util.isObject(opts.computed)) {\n    for (let prop in opts.computed) {\n      if (!util.isObject(opts.data)) {\n        opts.data = {};\n      }\n      if (!ctx._computedWatchers) {\n        ctx._computedWatchers = {};\n      }\n\n      const watcher = (((ctx._computedWatchers: any): Object)[\n        prop\n      ] = new Watcher(\n        opts.computed[prop].bind(opts),\n        cb ? cb.bind(opts, prop) : undefined,\n        true\n      ));\n\n      function createComputedGetter() {\n        if (watcher.dirty) {\n          watcher.evaluate();\n        }\n        if (Dep.target) {\n          watcher.depend();\n        }\n        return watcher.value;\n      }\n\n      Object.defineProperty(opts.data, prop, {\n        enumerable: true,\n        configurable: true,\n        set: util.noop,\n        get: createComputedGetter\n      });\n    }\n  }\n}\n\nclass Computed {\n  static util = util;\n  _computedWatchers: { [k: string | number]: Watcher } | void;\n  constructor(opts: any, cb?: Function) {\n    initData(opts);\n    initComputed(this, opts, cb);\n  }\n  getComputed(force?: boolean) {\n    var obj = {};\n    for (const prop in this._computedWatchers) {\n      const watcher = this._computedWatchers[prop];\n      if (force || watcher.dirty) {\n        watcher.evaluate();\n        const value = watcher.value;\n        Object.assign(obj, {\n          [prop]: value\n        });\n      }\n    }\n    return obj;\n  }\n}\n\nexport default Computed;\n","// @flow\nimport type Watcher from './watcher';\n\nlet $$dep_count = 0;\n\nclass Dep {\n  static target: Watcher | void;\n  subs: { [k: string | number]: Watcher };\n  id: number;\n  constructor() {\n    this.subs = {};\n    this.id = $$dep_count++;\n  }\n  addSub(watcher: Watcher) {\n    if (!this.subs[watcher.id]) {\n      this.subs[watcher.id] = watcher;\n    }\n  }\n  removeSub(watcher: Watcher) {\n    if (this.subs[watcher.id]) {\n      delete this.subs[watcher.id];\n    }\n  }\n\n  depend() {\n    if (Dep.target) {\n      Dep.target.addDep(this);\n    }\n  }\n  notify() {\n    for (const prop in this.subs) {\n      this.subs[prop].update();\n    }\n  }\n}\n\nexport default Dep;\n\nconst targetStack: Array<any> = [];\n\nexport function pushStack(o: any) {\n  targetStack.push(o);\n  Dep.target = o;\n}\n\nexport function popStack() {\n  targetStack.pop();\n  Dep.target = targetStack[targetStack.length - 1];\n}\n","import Computed from './computed';\n\nfunction ComputedPage(PageFunction) {\n  return function(PageConfigObject = {}) {\n    let computed;\n    const onLoad = PageConfigObject.onLoad;\n    PageConfigObject.onLoad = function(opts) {\n      computed = new Computed(PageConfigObject);\n      const setData = this.setData.bind(this);\n      this.setData = (obj = {}, cb) => {\n        setData(obj);\n        const computedData = computed.getComputed();\n        setData(computedData, (...args) => {\n          if (cb) {\n            cb.call(this, ...args);\n          }\n        });\n      };\n      onLoad.call(this, opts);\n    };\n    PageFunction(PageConfigObject);\n  };\n}\n\nexport default ComputedPage;\n","// @flow\nimport * as util from './util';\n\nfunction observe(obj: any): Observer | void {\n  if (!util.isObject(obj)) {\n    return;\n  }\n  let ob;\n  if (util.hasOwn(obj, '__ob__') && obj.__ob__ instanceof Observer) {\n    ob = obj.__ob__;\n  } else {\n    ob = new Observer(obj);\n  }\n  return ob;\n}\n\nclass Observer {\n  value: Object;\n  constructor(value: Object) {\n    this.value = value;\n    util.def(value, '__ob__', this);\n    this.walk(value);\n  }\n  walk(obj) {\n    const keys = Object.keys(obj);\n    for (let i = 0, l = keys.length; i < l; i++) {\n      util.defineReactive(obj, keys[i]);\n    }\n  }\n}\n\nexport default observe;\n","// @flow\n\nimport observe from './observe';\nimport Dep from './dep';\n\nexport function isObject(o: any): boolean {\n  return o && typeof o === 'object';\n}\n\nexport function hasOwn(o: Object, k: string | number) {\n  return Object.hasOwnProperty.call(o, k);\n}\n\nexport function def(\n  o: Object,\n  k: string | number,\n  value: any,\n  enumerable?: any\n) {\n  Object.defineProperty(o, k, {\n    configurable: true,\n    writable: true,\n    enumerable: !!enumerable,\n    value\n  });\n}\n\nexport function noop() {}\n\nexport function defineReactive(obj: Object, key: string | number, val?: any) {\n  const dep = new Dep();\n  const property = Object.getOwnPropertyDescriptor(obj, key);\n  if (property && property.configurable === false) {\n    return;\n  }\n  const getter = property && property.get;\n  const setter = property && property.set;\n\n  if ((!getter || setter) && arguments.length === 2) {\n    val = obj[key];\n  }\n\n  let childOb = observe(val);\n  Object.defineProperty(obj, key, {\n    get() {\n      const value = getter ? getter.call(obj) : val;\n\n      /**\n       * TODO\n       * 收集依赖\n       */\n\n      if (Dep.target) {\n        dep.depend();\n      }\n\n      return value;\n    },\n    set(newVal: any) {\n      const value = getter ? getter.call(obj) : val;\n      if (newVal === value) {\n        return;\n      }\n      if (getter && !setter) {\n        return;\n      } else if (setter) {\n        setter.call(obj, newVal);\n      } else {\n        val = newVal;\n      }\n      childOb = observe(newVal);\n      /**\n       * TODO\n       * 触发watcher\n       */\n      dep.notify();\n    }\n  });\n}\n","// @flow\n\nimport type Dep from './dep';\nimport { pushStack, popStack } from './dep';\nimport * as util from './util';\n\nlet $$watcher_count = 0;\n\nclass Watcher {\n  getter: () => any;\n  cb: ((a?: any, b?: any) => void) | void;\n  deps: { [k: string | number]: Dep };\n  newDeps: { [k: string | number]: Dep };\n  value: any;\n  id: number;\n  callUpdateManually: boolean | void;\n  dirty: boolean;\n  constructor(\n    getter: Function,\n    cb?: (a?: any, b?: any) => any,\n    callUpdateManually?: boolean\n  ) {\n    this.getter = getter;\n    this.cb = cb;\n    this.deps = {};\n    this.newDeps = {};\n    this.id = $$watcher_count++;\n    this.callUpdateManually = callUpdateManually;\n    this.dirty = !!callUpdateManually;\n    this.value = callUpdateManually ? undefined : this.get();\n  }\n  get() {\n    pushStack(this);\n    let val;\n    try {\n      val = this.getter();\n    } catch (err) {\n      throw err;\n    } finally {\n      popStack();\n      this.cleanupDeps();\n    }\n    return val;\n  }\n  update(force?: boolean) {\n    if (this.callUpdateManually) {\n      this.dirty = true;\n      return;\n    }\n    const value = this.get();\n    const oldValue = this.value;\n    if (force === true || value !== this.value || util.isObject(value)) {\n      if (force !== false && this.cb) {\n        this.cb(value, oldValue);\n      }\n      this.value = value;\n    }\n  }\n  evaluate() {\n    this.value = this.get();\n    this.dirty = false;\n  }\n  forceUpdate() {\n    this.update(true);\n  }\n  cleanupDeps() {\n    for (const id in this.deps) {\n      if (!this.newDeps[id]) {\n        this.deps[id].removeSub(this);\n      }\n    }\n    this.deps = this.newDeps;\n    this.newDeps = {};\n  }\n  addDep(dep: Dep) {\n    if (!this.newDeps[dep.id]) {\n      this.newDeps[dep.id] = dep;\n      if (!this.deps[dep.id]) {\n        dep.addSub(this);\n      }\n    }\n  }\n  depend() {\n    for (const prop in this.deps) {\n      this.deps[prop].depend();\n    }\n  }\n}\n\nexport default Watcher;\n"],"sourceRoot":""}