{"version":3,"sources":["webpack://Reh/webpack/universalModuleDefinition","webpack://Reh/webpack/bootstrap","webpack://Reh/./src/dep.js","webpack://Reh/./src/observe.js","webpack://Reh/./src/reh.js","webpack://Reh/./src/util.js","webpack://Reh/./src/watcher.js"],"names":["pushStack","popStack","$$dep_count","Dep","subs","id","watcher","target","addDep","prop","update","targetStack","o","push","console","log","pop","length","util","observe","obj","isObject","ob","hasOwn","__ob__","Observer","value","def","walk","keys","Object","i","l","defineReactive","initData","opts","data","initComputed","ctx","cb","computed","_computedWatchers","Watcher","bind","undefined","defineProperty","enumerable","configurable","set","noop","get","Reh","props","dirty","forceUpdate","k","hasOwnProperty","call","writable","key","val","dep","property","getOwnPropertyDescriptor","getter","setter","arguments","childOb","depend","newVal","notify","$$watcher_count","callUpdateManually","a","b","deps","err","cleanupDeps","force","oldValue","addSub"],"mappings":"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","file":"reh.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Reh\"] = factory();\n\telse\n\t\troot[\"Reh\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/reh.js\");\n","// @flow\nimport type Watcher from './watcher';\n\nlet $$dep_count = 0;\n\nclass Dep {\n  static target: Watcher | void;\n  subs: { [k: string | number]: Watcher };\n  id: number;\n  constructor() {\n    this.subs = {};\n    this.id = $$dep_count++;\n  }\n  addSub(watcher: Watcher) {\n    if (!this.subs[watcher.id]) {\n      this.subs[watcher.id] = watcher;\n    }\n  }\n  removeSub(watcher: Watcher) {\n    if (this.subs[watcher.id]) {\n      delete this.subs[watcher.id];\n    }\n  }\n\n  depend() {\n    if (Dep.target) {\n      Dep.target.addDep(this);\n    }\n  }\n  notify() {\n    for (const prop in this.subs) {\n      this.subs[prop].update();\n    }\n  }\n}\n\nexport default Dep;\n\nconst targetStack: Array<any> = [];\n\nexport function pushStack(o: any) {\n  targetStack.push(o);\n  Dep.target = o;\n  console.log('pushStack: ', targetStack);\n}\n\nexport function popStack() {\n  targetStack.pop();\n  Dep.target = targetStack[targetStack.length - 1];\n  console.log('popStack: ', targetStack);\n}\n","// @flow\nimport * as util from './util';\n\nfunction observe(obj: any): Observer | void {\n  if (!util.isObject(obj)) {\n    return;\n  }\n  let ob;\n  if (util.hasOwn(obj, '__ob__') && obj.__ob__ instanceof Observer) {\n    ob = obj.__ob__;\n  } else {\n    ob = new Observer(obj);\n  }\n  return ob;\n}\n\nclass Observer {\n  value: Object;\n  constructor(value: Object) {\n    this.value = value;\n    util.def(value, '__ob__', this);\n    this.walk(value);\n  }\n  walk(obj) {\n    const keys = Object.keys(obj);\n    for (let i = 0, l = keys.length; i < l; i++) {\n      util.defineReactive(obj, keys[i]);\n    }\n  }\n}\n\nexport default observe;\n","// @flow\n\nimport * as util from './util';\nimport observe from './observe';\nimport Watcher from './watcher';\nimport Dep from './dep';\n\nfunction initData(opts: any) {\n  if (util.isObject(opts) && util.isObject(opts.data)) {\n    for (const prop in opts.data) {\n      observe(opts.data);\n    }\n  }\n}\n\nfunction initComputed(ctx: Reh, opts: Object, cb?: Function) {\n  if (util.isObject(opts) && util.isObject(opts.computed)) {\n    for (let prop in opts.computed) {\n      if (!util.isObject(opts.data)) {\n        opts.data = {};\n      }\n      if (!ctx._computedWatchers) {\n        ctx._computedWatchers = {};\n      }\n\n      const watcher = (((ctx._computedWatchers: any): Object)[\n        prop\n      ] = new Watcher(\n        opts.computed[prop].bind(opts),\n        cb ? cb.bind(opts) : undefined,\n        true\n      ));\n      const o = {};\n      Object.defineProperty(o, prop, {\n        enumerable: false,\n        configurable: true,\n        set: util.noop,\n        get: watcher.get.bind(watcher)\n      });\n      util.defineReactive(opts.data, prop, o[prop]);\n    }\n  }\n}\n\nclass Reh {\n  static util = util;\n  _computedWatchers: { [k: string | number]: Watcher } | void;\n  constructor(opts: any, cb?: Function) {\n    initData(opts);\n    initComputed(this, opts, cb);\n  }\n  execDirtyWatcher() {\n    if (this._computedWatchers) {\n      const props = Object.keys(this._computedWatchers);\n      for (let i = 0, l = props.length; i < l; i++) {\n        const watcher = this._computedWatchers[props[i]];\n        if (watcher.dirty) {\n          watcher.forceUpdate();\n        }\n      }\n    }\n  }\n}\n\nexport default Reh;\n","// @flow\n\nimport observe from './observe';\nimport Dep from './dep';\n\nexport function isObject(o: any): boolean {\n  return o && typeof o === 'object';\n}\n\nexport function hasOwn(o: Object, k: string | number) {\n  return Object.hasOwnProperty.call(o, k);\n}\n\nexport function def(\n  o: Object,\n  k: string | number,\n  value: any,\n  enumerable?: any\n) {\n  Object.defineProperty(o, k, {\n    configurable: true,\n    writable: true,\n    enumerable: !!enumerable,\n    value\n  });\n}\n\nexport function noop() {}\n\nexport function defineReactive(obj: Object, key: string | number, val?: any) {\n  const dep = new Dep();\n  const property = Object.getOwnPropertyDescriptor(obj, key);\n  if (property && property.configurable === false) {\n    return;\n  }\n\n  const getter = property && property.get;\n  const setter = property && property.set;\n\n  if ((!getter || setter) && arguments.length === 2) {\n    val = obj[key];\n  }\n\n  let childOb = observe(val);\n  Object.defineProperty(obj, key, {\n    get() {\n      const value = getter ? getter.call(obj) : val;\n\n      /**\n       * TODO\n       * 收集依赖\n       */\n\n      if (Dep.target) {\n        dep.depend();\n      }\n\n      return value;\n    },\n    set(newVal: any) {\n      const value = getter ? getter.call(obj) : val;\n      if (newVal === value) {\n        return;\n      }\n      if (getter && !setter) {\n        return;\n      } else if (setter) {\n        setter.call(obj, newVal);\n      } else {\n        val = newVal;\n      }\n      childOb = observe(newVal);\n      /**\n       * TODO\n       * 触发watcher\n       */\n      dep.notify();\n    }\n  });\n}\n","// @flow\n\nimport type Dep from './dep';\nimport { pushStack, popStack } from './dep';\nimport * as util from './util';\n\nlet $$watcher_count = 0;\n\nclass Watcher {\n  getter: () => any;\n  cb: ((a?: any, b?: any) => void) | void;\n  deps: { [k: string | number]: Dep };\n  value: any;\n  id: number;\n  callUpdateManually: boolean | void;\n  dirty: boolean = false;\n  constructor(\n    getter: Function,\n    cb?: (a?: any, b?: any) => any,\n    callUpdateManually?: boolean\n  ) {\n    this.getter = getter;\n    this.cb = (a, b) => {\n      this.dirty = false;\n      if (cb) {\n        cb(a, b);\n      }\n    };\n    this.deps = {};\n    this.id = $$watcher_count++;\n    this.callUpdateManually = callUpdateManually;\n    this.value = this.get();\n  }\n  get() {\n    pushStack(this);\n\n    let val;\n    try {\n      val = this.getter();\n    } catch (err) {\n      throw err;\n    } finally {\n      popStack();\n      this.cleanupDeps();\n    }\n    return val;\n  }\n  update(force?: boolean) {\n    const value = this.get();\n    const oldValue = this.value;\n    if (force === true || value !== this.value || util.isObject(value)) {\n      this.dirty = true;\n      if (\n        (force === true || (!this.callUpdateManually && force !== false)) &&\n        this.cb\n      ) {\n        this.cb(value, oldValue);\n      }\n      this.value = value;\n    }\n  }\n  forceUpdate() {\n    this.update(true);\n  }\n  cleanupDeps() {\n    this.deps = {};\n  }\n  addDep(dep: Dep) {\n    if (!this.deps[dep.id]) {\n      this.deps[dep.id] = dep;\n      dep.addSub(this);\n    }\n  }\n  depend() {\n    for (const prop in this.deps) {\n      this.deps[prop].depend();\n    }\n  }\n}\n\nexport default Watcher;\n"],"sourceRoot":""}